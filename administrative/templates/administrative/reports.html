{% extends "base.html" %}
{% load static %}
{% block title %}Reportes{% endblock %}
{% block nav_title %}Reportes{% endblock %}

{% block content %}
<main>
  <div class="container">
    <div class="row">
      <div class="col s12 m6" id="chart_div"></div>
      <div class="col s12 m6" id="chart_div_2"></div>
    </div>

  </div>
</main>
{% endblock %}

{% block js %}
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

      // Load the Visualization API and the corechart package.
      google.charts.load('current', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawChart);

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      function drawChart() {
        path = "/administrative/reports/municipality_beneficiaries/";
        $.ajax({
          method: "GET",
          url: path
        }).done(function(res) {
          // Create the data table.
          var data = new google.visualization.DataTable();
          rows = [];
          for (i = 0; i < res.labels.length; i++){
            rows.push([res.labels[i], res.beneficiaries[i]]);
          }
          data.addColumn('string', 'Municipio');
          data.addColumn('number', 'Beneficiarios');
          data.addRows(rows);

          // Set chart options
          var options = {'title':'Beneficiarios por municipio',
                         'width':400,
                         'height':300};

          // Instantiate and draw our chart, passing in some options.
          var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
          chart.draw(data, options);
        });
        path = "/administrative/reports/program_beneficiaries/";
        $.ajax({
          method: "GET",
          url: path
        }).done(function(res) {
          // Create the data table.
          var data = new google.visualization.DataTable();
          rows = [];
          for (i = 0; i < res.labels.length; i++){
            rows.push([res.labels[i], res.beneficiaries[i]]);
          }
          data.addColumn('string', 'Program');
          data.addColumn('number', 'Beneficiarios');
          data.addRows(rows);

          // Set chart options
          var options = {'title':'Beneficiarios por programa',
                         'width':400,
                         'height':300};

          // Instantiate and draw our chart, passing in some options.
          var chart = new google.visualization.PieChart(document.getElementById('chart_div_2'));
          chart.draw(data, options);
        });
      }
    </script>
{% endblock %}
